<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TAWAKAL NON-VAGE </title>
  <meta name="description" content="Tawakal Non-Veg -Fresh, flavorful non-veg dishes served with homely Taste and real spices." />
  <meta name="theme-color" content="#F59E0B"/>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Minor custom styles to complement Tailwind */
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    /* subtle focus ring for keyboard users */
    .focus-ring:focus { outline: 3px solid rgba(245,158,11,0.25); outline-offset: 2px; }
    /* screen-reader only */
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
    /* small animation */
    .fade-in { animation: fadeIn 400ms ease both; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(6px);} to { opacity: 1; transform: translateY(0);} }
    .whatsapp-btn { background: linear-gradient(90deg,#25D366,#128C7E); }
    /* dark mode helpers (class switch) */
    .dark-mode body { background: #0b1220; color: #e6eef8; }
    .dark-mode .bg-white { background: #0f1724; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800 antialiased">

  <!-- =======================
       TOPBAR (dark mode + contact)
       ======================= -->
  <div class="bg-yellow-600 text-white py-1 text-sm">
    <div class="max-w-7xl mx-auto px-6 flex justify-between items-center">
      <div>Free delivery on orders above Any Orders ‚Ä¢ Jam Khambhaliya, Gujarat</div>
      <div class="flex items-center gap-4">
        <button id="darkToggle" class="px-2 py-1 bg-yellow-500/20 rounded">Dark</button>
        <a href="tel:+918140314361" class="underline">üìû 8140314361</a>
      </div>
    </div>
  </div>

  <!-- =======================
       NAVBAR (Original look)
       ======================= -->
  <header class="bg-white shadow sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-6 py-3 flex justify-between items-center">
      <!-- Logo -->
      <a href="#home" class="flex items-center gap-3" aria-label="Golden Bites Home">
        <div class="w-10 h-10 rounded-full bg-yellow-500 flex items-center justify-center text-white font-bold shadow">T</div>
        <span class="text-2xl font-bold text-yellow-600">TAWAKAL NON-VAGE</span>
      </a>

      <!-- Nav (hidden on small screens) -->
      <nav class="hidden md:flex gap-6 text-base font-medium" aria-label="Primary">
        <a href="#home" class="hover:text-yellow-600 focus-ring">Home</a>
        <a href="#products" class="hover:text-yellow-600 focus-ring">Products</a>
        
        <a href="#faq" class="hover:text-yellow-600 focus-ring">FAQ</a>
        <a href="#contact" class="hover:text-yellow-600 focus-ring">Contact</a>
      </nav>

      <!-- Right group: Cart & Mobile menu -->
      <div class="flex items-center gap-4">
        <!-- Order history quick access -->
        <button id="historyBtn" class="hidden sm:inline-flex items-center gap-2 px-3 py-1 rounded hover:bg-gray-100 focus-ring" title="View Order History">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-gray-700" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7h18M3 12h18M3 17h18"/></svg>
          <span class="text-sm">Orders</span>
        </button>

        <!-- Cart Button -->
        <button id="cartBtn" aria-label="Open cart" class="relative cursor-pointer w-10 h-10 rounded-lg hover:bg-gray-100 flex items-center justify-center focus-ring" title="Cart">
          <!-- cart icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.35 2.7A1 1 0 007.6 17h9.8a1 1 0 00.9-.6L21 9H6.4M7 13h10" />
          </svg>
          <span id="cartCount" class="absolute -top-1 -right-2 bg-yellow-600 text-white text-xs font-bold rounded-full px-1.5 py-0.5 border border-white">0</span>
        </button>

        <!-- Mobile menu button -->
        <button id="mobileMenuBtn" class="md:hidden p-2 rounded hover:bg-gray-100 focus-ring" aria-label="Open menu">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile nav dropdown (accessible) -->
    <div id="mobileNav" class="md:hidden hidden border-t bg-white">
      <div class="px-4 py-3 flex flex-col gap-2">
        <a href="#home" class="px-2 py-1 rounded hover:bg-gray-50">Home</a>
        <a href="#products" class="px-2 py-1 rounded hover:bg-gray-50">Products</a>
        
        <a href="#faq" class="px-2 py-1 rounded hover:bg-gray-50">FAQ</a>
        <a href="#contact" class="px-2 py-1 rounded hover:bg-gray-50">Contact</a>
      </div>
    </div>
  </header>

  <!-- =======================
       HERO SECTION (Adjusted image)
       ======================= -->
  <main>
    <section id="home" class="relative bg-yellow-100">
      <div class="max-w-7xl mx-auto px-6 py-12 flex flex-col md:flex-row items-center gap-8">
        <!-- Left: Text -->
        <div class="flex-1 text-center md:text-left">
          <h1 class="text-4xl md:text-5xl font-extrabold text-yellow-700 leading-tight">
            The  Taste of Tradition,<br/>with a Modern Touch.
          </h1>
          <p class="mt-3 text-gray-700 text-lg max-w-2xl mx-auto md:mx-0">
            Freshly cooked Non-Veg, made with premium spices and served with authentic taste ‚Äî delivered straight to your home. Relish the tradition with a modern twist.
          </p>
          <div class="mt-6 flex items-center justify-center md:justify-start gap-3">
            <a href="#products" class="bg-yellow-600 text-white px-6 py-3 rounded-lg shadow hover:bg-yellow-700 transition focus-ring">Shop Now</a>
            
          </div>
        </div>

        <!-- Right: Controlled Image -->
        <div class="flex-1 flex justify-center md:justify-end">
          <picture>
            <source srcset="thali2.webp" />
            <img
              id="heroImage"
              src="https://images.unsplash.com/photo-1601050690597-3a48d40cb3cf?auto=format&fit=crop&w=900&q=80"
              alt=‚ÄúTawakal Non Veg  Real Taste Bites"
              class="rounded-2xl shadow-lg w-full max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg object-cover max-h-72 md:max-h-80"
              width="720" height="480"
              loading="eager"
            />
          </picture>
        </div>
      </div>
    </section>

    <!-- =======================
         PRODUCTS GRID
         ======================= -->
    <section id="products" class="max-w-7xl mx-auto px-6 py-12">
      <h2 class="text-3xl font-bold text-center text-yellow-700 mb-10">Menu</h2>
      <div id="productsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8" aria-live="polite"></div>

      <!-- Extra Categories (expanded to reach 1000+ lines and provide product variety) -->
      
        </div>
      </div>
    </section>

    <!-- =======================
         TESTIMONIALS (added)
         ======================= -->
    <section id="testimonials" class="bg-white py-12 border-t border-gray-200">
      <div class="max-w-7xl mx-auto px-6">
        <h2 class="text-3xl font-bold text-yellow-700 text-center mb-8">What Our Customers Say</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <blockquote class="p-6 bg-yellow-50 rounded-lg">
            <p class="italic">"Every bite of Tawakal Non-Veg feels like home ‚Äî tender, spicy, and unforgettable."</p>
            <footer class="mt-4 text-sm font-semibold">‚Äî Dilip K.</footer>
          </blockquote>
          <blockquote class="p-6 bg-yellow-50 rounded-lg">
            <p class="italic">"Fresh ingredients and fast delivery. Highly recommended!"</p>
            <footer class="mt-4 text-sm font-semibold">‚Äî Rajesh P.</footer>
          </blockquote>
          <blockquote class="p-6 bg-yellow-50 rounded-lg">
            <p class="italic">"Loved the Mutton Curry ‚Äî tender pieces & rich gravy in every bite."</p>
            <footer class="mt-4 text-sm font-semibold">‚Äî Anjali S.</footer>
          </blockquote>
        </div>
      </div>
    </section>

    <!-- =======================
         ABOUT & CONTACT
         ======================= -->
    <section id="about" class="max-w-7xl mx-auto px-6 py-10 border-t border-gray-200">
      <div class="md:flex gap-8 items-center">
        <div class="md:w-1/2">
          <img src="nonvage2.jpg" alt="About Golden Bites" class="rounded-2xl shadow-lg w-full object-cover h-64" />
        </div>
        <div class="md:w-1/2">
          <h3 class="text-3xl font-bold text-yellow-700 mb-3">About Tawakal Non-Vage</h3>
          <p class="text-gray-700 mb-2">Tawakal Non Veg started with a love for authentic flavors. For the last 15 years, we‚Äôve been serving freshly cooked non-veg dishes made with premium spices and the finest ingredients.</p>
          <p class="text-gray-700">We believe food is more than just a meal ‚Äî it‚Äôs comfort, it‚Äôs tradition, and it‚Äôs pride. That‚Äôs why every dish we serve carries the same homely taste our customers have trusted for years.‚Äù</p>
        </div>
      </div>
    </section>

    <!-- =======================
         FAQ (accordion)
         ======================= -->
    <section id="faq" class="max-w-7xl mx-auto px-6 py-12 bg-yellow-50 border-t border-gray-200">
      <h2 class="text-3xl font-bold text-yellow-700 text-center mb-8">Frequently Asked Questions</h2>
      <div class="max-w-4xl mx-auto space-y-3">
        <details class="bg-white p-4 rounded-lg" open>
          <summary class="font-semibold cursor-pointer">How long does delivery take?</summary>
          <p class="mt-2 text-sm text-gray-600">Delivery is typically within 24‚Äì48 hours depending on location.</p>
        </details>
        <details class="bg-white p-4 rounded-lg">
          <summary class="font-semibold cursor-pointer">Do you accept COD?</summary>
          <p class="mt-2 text-sm text-gray-600">Yes ‚Äî Cash on Delivery is available. We also support bank transfers and UPI.</p>
        </details>
        <details class="bg-white p-4 rounded-lg">
          <summary class="font-semibold cursor-pointer">Can I order in bulk for events?</summary>
          <p class="mt-2 text-sm text-gray-600">Yes ‚Äî contact us on WhatsApp at 8140314361 for bulk orders and discounts.</p>
        </details>
      </div>
    </section>

    <!-- =======================
         NEWSLETTER SIGNUP (demo)
         ======================= -->
   
    <section id="contact" class="bg-yellow-50 py-10 border-t border-gray-200">
      <div class="max-w-4xl mx-auto px-6 text-center">
        <h4 class="text-3xl font-bold text-yellow-700 mb-6">Contact Us</h4>
        <p class="text-gray-700 mb-1">üìç Jam Khambhaliya, Gujarat</p>
        <p class="text-gray-700">üìß sumarpupar@gmail.com</p>
      </div>
    </section>
  </main>

  <!-- =======================
       FOOTER
       ======================= -->
  <footer class="bg-yellow-600 text-white py-6 border-t border-gray-300 mt-8">
    <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center">
      <p>&copy; <span id="year"></span>Tawakal Non Veg. Taste Redefined.</p>
      
    </div>
  </footer>

  <!-- =======================
       CART SIDEBAR
       ======================= -->
  <aside id="cartSidebar" class="fixed top-0 right-0 w-96 max-w-full h-full bg-white shadow-lg transform translate-x-full transition-transform duration-300 p-6 z-50 flex flex-col" aria-hidden="true">
    <div class="flex justify-between items-center mb-4 border-b pb-3">
      <h3 class="text-xl font-bold text-yellow-700">Your Cart</h3>
      <button onclick="toggleCart()" aria-label="Close cart" class="text-gray-500 hover:text-red-500 text-2xl font-bold">&times;</button>
    </div>

    <ul id="cartItems" class="space-y-3 flex-1 overflow-y-auto no-scrollbar" aria-live="polite"></ul>

    <div class="mt-4 border-t pt-4">
      <div class="flex justify-between font-semibold text-lg mb-3">
        <span>Total:</span>
        <span id="cartTotal">‚Çπ0</span>
      </div>
      <div class="flex gap-3">
        <button id="checkoutBtn" onclick="beginCheckout()" class="w-full bg-yellow-600 text-white py-2 rounded-lg shadow hover:bg-yellow-700 transition focus-ring">Checkout</button>
        <button id="clearCartBtn" class="w-20 bg-gray-100 rounded flex items-center justify-center hover:bg-gray-200" title="Clear cart">üßπ</button>
      </div>
    </div>
  </aside>

  <!-- =======================
       CHECKOUT FORM SIDEBAR
       ======================= -->
  <aside id="checkoutForm" class="fixed top-0 right-0 w-96 h-full bg-white shadow-lg transform translate-x-full transition-transform duration-300 p-6 z-60" aria-hidden="true">
    <div class="flex justify-between items-center mb-4 border-b pb-3">
      <h3 class="text-xl font-bold text-yellow-700">Delivery Details</h3>
      <button onclick="closeCheckoutForm()" aria-label="Close checkout" class="text-gray-500 hover:text-red-500 text-2xl font-bold">&times;</button>
    </div>

    <form id="orderForm" class="space-y-4" novalidate>
      <div>
        <label for="custName" class="block text-sm font-medium text-gray-700">Name</label>
        <input id="custName" type="text" required class="mt-1 block w-full rounded-lg border px-3 py-2 focus-ring" placeholder="Full name" />
        <p id="custNameError" class="text-xs text-red-500 mt-1 hidden">Please enter your name.</p>
      </div>

      <div>
        <label for="custMobile" class="block text-sm font-medium text-gray-700">Mobile</label>
        <input id="custMobile" type="tel" pattern="[0-9]{10}" maxlength="10" required class="mt-1 block w-full rounded-lg border px-3 py-2 focus-ring" placeholder="10 digit mobile" />
        <p id="custMobileError" class="text-xs text-red-500 mt-1 hidden">Enter a valid 10-digit mobile number.</p>
      </div>

      <div>
        <label for="custAddress" class="block text-sm font-medium text-gray-700">Address</label>
        <textarea id="custAddress" rows="3" required class="mt-1 block w-full rounded-lg border px-3 py-2 focus-ring" placeholder="Enter Your Address In Khambhaliya"></textarea>
        <p id="custAddressError" class="text-xs text-red-500 mt-1 hidden">Please enter delivery address.</p>
      </div>

      <div>
        <!-- SAVE & CONTINUE -> we will open WhatsApp summary instead of payment -->
        <button id="saveContinueBtn" type="submit" class="w-full bg-yellow-600 text-white py-2 rounded-lg shadow hover:bg-yellow-700 focus-ring">Save & Continue</button>
      </div>
    </form>
  </aside>

  <!-- =======================
       WHATSAPP SUMMARY PAGE (replaces payment modal/page)
       - This page shows order summary, Back option and "Send to WhatsApp"
       - Back returns to checkout form (so user can edit)
       ======================= -->
  <div id="whatsappPage" class="fixed inset-0 bg-black/60 hidden z-80 flex items-center justify-center p-4" aria-hidden="true">
    <div class="bg-white rounded-lg max-w-md w-full p-6 text-center">
      <h3 id="waTitle" class="text-xl font-bold text-yellow-700 mb-4">Send Order via WhatsApp</h3>
      <p id="waSummary" class="text-gray-700 mb-4"></p>

      <div class="space-y-3">
        <button id="sendWhatsAppBtn" class="w-full py-2 rounded whatsapp-btn text-white">Send to WhatsApp</button>
        <!-- Back button to go back to checkout form so user can edit details -->
        <button id="backToCheckoutBtn" class="w-full py-2 rounded border">Back</button>
      </div>

      <p class="text-sm text-gray-500 mt-3">This will open WhatsApp on your device. We will mark the order as sent via WhatsApp.</p>
    </div>
  </div>

  <!-- =======================
       ORDER SUCCESS & HISTORY
       ======================= -->
  <div id="orderSuccess" class="fixed inset-0 bg-black/60 hidden z-90 flex items-center justify-center p-4" aria-hidden="true">
    <div class="bg-white rounded-lg max-w-md w-full p-6 text-center">
      <h3 class="text-2xl font-bold text-yellow-700 mb-3">Order Sent ‚úÖ</h3>
      <p id="orderSuccessMsg" class="text-gray-700 mb-4"></p>
      <div class="flex justify-center gap-3">
        <button onclick="closeSuccess()" class="bg-yellow-600 text-white px-6 py-2 rounded">OK</button>
        <button onclick="openOrderHistory()" class="px-6 py-2 rounded border">View Orders</button>
      </div>
    </div>
  </div>

  <!-- Order History Modal -->
  <div id="historyModal" class="fixed inset-0 bg-black/60 hidden z-95 flex items-center justify-center p-4" aria-hidden="true">
    <div class="bg-white rounded-lg max-w-3xl w-full p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold text-yellow-700">Order History</h3>
        <div class="flex gap-2 items-center">
          <button onclick="clearOrders()" class="px-3 py-1 rounded bg-red-600 text-white">Clear All</button>
          <button onclick="closeOrderHistory()" class="px-3 py-1 rounded border">Close</button>
        </div>
      </div>
      <div id="ordersList" class="space-y-4 max-h-96 overflow-y-auto no-scrollbar"></div>
      <p id="noOrdersMsg" class="text-gray-500 mt-4 hidden">No orders yet.</p>
    </div>
  </div>

  <!-- =======================
       LOADING SPINNER (demo)
       ======================= -->
  <div id="loadingSpinner" class="fixed inset-0 z-100 hidden items-center justify-center bg-black/20">
    <div class="rounded-full p-4 bg-white shadow">
      <svg class="animate-spin h-8 w-8 text-yellow-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
      </svg>
    </div>
  </div>

  <!-- =======================
       SCRIPTS: Cart, Checkout, WhatsApp Flow
       ======================= -->
  <script>
    /* ------------------------------
       Utilities & Persistent Storage
       ------------------------------ */
    const STORAGE = {
      CART: 'gb_cart_v1',
      ADDRESS: 'gb_address_v1',
      ORDERS: 'gb_orders_v1',
      PENDING: 'gb_pending_v1'
    };

    function save(key, value) {
      localStorage.setItem(key, JSON.stringify(value));
    }
    function load(key) {
      try { return JSON.parse(localStorage.getItem(key)); } catch (e) { return null; }
    }
    function formatCurrency(n) { return '‚Çπ' + Number(n).toLocaleString('en-IN'); }
    function uid(prefix='ID'){ return prefix + '-' + Date.now().toString(36) + '-' + Math.random().toString(36).slice(2,8); }

    /* ------------------------------
       Initial Data (Products)
       ------------------------------ */
    const PRODUCTS = [
      { id: 'p1', name: 'Gravy Chicken', price: 200, desc: 'Made with homely taste & restaurant-style flavor', img: 'chikengravy.png' },
      { id: 'p2', name: 'Gravy Mutton', price: 250, desc: 'Loaded with tender mutton & rich spices', img: 'mutton.webp' },
      { id: 'p3', name: 'Jinga', price: 200, desc: 'Ocean‚Äôs freshness cooked with authentic masala', img: 'jinga.jpg' },
      // Extra products to make the store feel complete
      { id: 'p4', name: 'Fish', price: 200, desc: 'Ocean Fresh Flavor', img: 'fish.jpg' },
      { id: 'p5', name: 'Chicken Biryani', price: 220, desc: 'Chicken Biryani ‚Äî Tradition Served Hot', img: 'chikenbiryani.jpg' },
      { id: 'p6', name: 'Mutton Biryani', price: 280, desc: 'Mutton Biryani ‚Äî A taste of royal tradition', img: 'muttonbiryani.jpg' },
      { id: 'p7', name: 'Jinga Biryani', price: 250, desc: 'Jinga Biryani ‚Äî Coastal freshness meets royal spice', img: 'jingabiryani.jpg' },
      { id: 'p9', name: 'Fish Biryani', price: 250, desc: 'Fish Biryani ‚Äî Coastal taste with royal spice', img: 'fishbiryani.webp' },
      { id: 'p10', name: 'Chicken Masala', price: 220, desc: 'Every bite bursting with masala magic', img: 'chikenmasala.jpg' },
      { id: 'p11', name: 'Mutton Masala', price: 300, desc: 'Mutton Masala ‚Äî Spiced with tradition, served with love', img: 'muttonmasala.jpg' },
      { id: 'p12', name: 'Jinga Masala', price: 250, desc: 'Jinga Masala ‚Äî Ocean freshness with desi spices', img: 'jinga2.webp' },
      { id: 'p13', name: 'Fish Masala', price: 250, desc: 'Fish Masala ‚Äî Ocean flavor with desi spice', img: 'fishmasala.jpg' },
      { id: 'p14', name: 'Rotla', price: 25, desc: 'Soft, fresh & homely ‚Äî just like Ghar ka Rotla', img: 'rotla.jpg' },
      { id: 'p15', name: 'Rotli', price: 15, desc: 'Soft & fresh Rotli ‚Äî the soul of every meal', img: 'rotli.jpg' }

    ];

    /* ------------------------------
       State
       ------------------------------ */
    let cart = load(STORAGE.CART) || [];                      // array of {id,name,price,qty}
    let lastAddress = load(STORAGE.ADDRESS) || null;          // {name,mobile,address}
    let pendingOrder = load(STORAGE.PENDING) || null;         // saved while awaiting whatsapp send
    let orders = load(STORAGE.ORDERS) || [];                  // completed orders

    /* ------------------------------
       DOM Refs
       ------------------------------ */
    const productsGrid = document.getElementById('productsGrid');
    const cartItemsEl = document.getElementById('cartItems');
    const cartCountEl = document.getElementById('cartCount');
    const cartTotalEl = document.getElementById('cartTotal');
    const cartSidebar = document.getElementById('cartSidebar');
    const mobileNav = document.getElementById('mobileNav');
    const yearSpan = document.getElementById('year');

    const orderForm = document.getElementById('orderForm');
    const checkoutForm = document.getElementById('checkoutForm');

    const whatsappPage = document.getElementById('whatsappPage');
    const waTitle = document.getElementById('waTitle');
    const waSummary = document.getElementById('waSummary');
    const sendWhatsAppBtn = document.getElementById('sendWhatsAppBtn');
    const backToCheckoutBtn = document.getElementById('backToCheckoutBtn');

    const orderSuccess = document.getElementById('orderSuccess');
    const orderSuccessMsg = document.getElementById('orderSuccessMsg');

    const historyModal = document.getElementById('historyModal');
    const ordersList = document.getElementById('ordersList');
    const noOrdersMsg = document.getElementById('noOrdersMsg');

    const loadingSpinner = document.getElementById('loadingSpinner');

    /* ------------------------------
       Init UI
       ------------------------------ */
    yearSpan.textContent = new Date().getFullYear();

    function renderProducts() {
      productsGrid.innerHTML = '';
      PRODUCTS.forEach(p => {
        const card = document.createElement('article');
        card.className = 'bg-white rounded-2xl shadow hover:shadow-xl transition p-4 flex flex-col';
        card.innerHTML = `
          <img src="${p.img}" alt="${p.name}" class="rounded-lg mb-4 object-cover h-52 w-full" loading="lazy"/>
          <h3 class="text-xl font-semibold">${p.name}</h3>
          <p class="text-gray-600 mb-2">${p.desc}</p>
          <div class="mt-auto flex items-center justify-between">
            <div class="text-yellow-700 font-bold text-lg">${formatCurrency(p.price)}</div>
            <div class="flex gap-2">
              <button class="bg-gray-100 px-3 py-1 rounded text-sm" aria-label="View details">Details</button>
              <button class="bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 focus-ring" aria-label="Add ${p.name} to cart">Add</button>
            </div>
          </div>
        `;
        card.querySelectorAll('button')[1].addEventListener('click', () => { addToCart(p.id); });
        productsGrid.appendChild(card);
      });
    }

    renderProducts();

    /* ------------------------------
       Cart helpers
       ------------------------------ */
    function persistCart() { save(STORAGE.CART, cart); }
    function persistAddress() { if (lastAddress) save(STORAGE.ADDRESS, lastAddress); }
    function persistOrders() { save(STORAGE.ORDERS, orders); }
    function persistPending() { if (pendingOrder) save(STORAGE.PENDING, pendingOrder); else localStorage.removeItem(STORAGE.PENDING); }

    function findProduct(pid) { return PRODUCTS.find(p => p.id === pid); }

    function addToCart(productId) {
      const p = findProduct(productId);
      if (!p) return;
      const existing = cart.find(i => i.id === productId);
      if (existing) existing.qty += 1;
      else cart.push({ id: p.id, name: p.name, price: p.price, qty: 1 });
      persistCart();
      updateCart();
      openCart();
      announce(`${p.name} added to cart`);
    }

    function changeQty(index, delta) {
      if (!cart[index]) return;
      cart[index].qty += delta;
      if (cart[index].qty <= 0) cart.splice(index, 1);
      persistCart();
      updateCart();
    }

    function removeItem(index) {
      if (!cart[index]) return;
      cart.splice(index, 1);
      persistCart();
      updateCart();
    }

    function clearCart() {
      cart = [];
      persistCart();
      updateCart();
      announce('Cart cleared');
    }

    function computeTotal() { return cart.reduce((s, i) => s + (i.price * i.qty), 0); }

    function updateCart() {
      const totalQty = cart.reduce((s,i)=> s + i.qty, 0);
      cartCountEl.textContent = totalQty;
      cartItemsEl.innerHTML = '';

      if (cart.length === 0) {
        cartItemsEl.innerHTML = `<p class="text-yellow-600 font-bold text-center mt-10 text-lg animate-bounce">ORDER NOW!!</p>`;
      } else {
        cart.forEach((item, idx) => {
          const li = document.createElement('li');
          li.className = 'flex justify-between items-center border-b pb-2';
          li.innerHTML = `
            <div>
              <div class="font-medium">${escapeHtml(item.name)}</div>
              <div class="text-sm text-gray-500">${formatCurrency(item.price)} √ó ${item.qty} = ${formatCurrency(item.qty * item.price)}</div>
            </div>
            <div class="flex items-center gap-2">
              <button aria-label="Decrease quantity" class="px-2 py-1 text-sm border rounded">‚àí</button>
              <div class="px-2">${item.qty}</div>
              <button aria-label="Increase quantity" class="px-2 py-1 text-sm border rounded">+</button>
              <button aria-label="Remove item" class="text-red-500 ml-2 font-bold">‚úï</button>
            </div>
          `;
          const buttons = li.querySelectorAll('button');
          buttons[0].addEventListener('click', () => changeQty(idx, -1));
          buttons[1].addEventListener('click', () => changeQty(idx, +1));
          buttons[2].addEventListener('click', () => removeItem(idx));
          cartItemsEl.appendChild(li);
        });
      }

      cartTotalEl.textContent = formatCurrency(computeTotal());
    }

    /* ------------------------------
       Accessibility announce
       ------------------------------ */
    function announce(text) {
      let el = document.getElementById('srAnnounce');
      if (!el) {
        el = document.createElement('div');
        el.id = 'srAnnounce';
        el.setAttribute('aria-live', 'polite');
        el.className = 'sr-only';
        document.body.appendChild(el);
      }
      el.textContent = text;
    }

    /* ------------------------------
       Cart / Sidebar controls
       ------------------------------ */
    function toggleCart() {
      const hidden = cartSidebar.classList.toggle('translate-x-full');
      const ariaHidden = cartSidebar.getAttribute('aria-hidden') === 'true';
      cartSidebar.setAttribute('aria-hidden', !ariaHidden);
    }
    function openCart() {
      cartSidebar.classList.remove('translate-x-full');
      cartSidebar.setAttribute('aria-hidden', 'false');
    }

    document.getElementById('clearCartBtn').addEventListener('click', () => {
      if (confirm('Clear the cart?')) clearCart();
    });

    document.getElementById('mobileMenuBtn').addEventListener('click', () => {
      mobileNav.classList.toggle('hidden');
    });

    document.getElementById('cartBtn').addEventListener('click', toggleCart);

    /* ------------------------------
       Checkout Flow (modified)
       - On submit we open the whatsappPage (summary)
       - Back button returns to checkout form (so user can edit)
       - Send to WhatsApp opens wa.me link to your number with formatted message
       - After sending we mark order in orders[] with status "Sent via WhatsApp"
       ------------------------------ */

    function beginCheckout() {
      if (cart.length === 0) { alert('Your cart is empty ‚Äî please add items first.'); return; }
      if (lastAddress) {
        document.getElementById('custName').value = lastAddress.name || '';
        document.getElementById('custMobile').value = lastAddress.mobile || '';
        document.getElementById('custAddress').value = lastAddress.address || '';
      } else {
        document.getElementById('custName').value = '';
        document.getElementById('custMobile').value = '';
        document.getElementById('custAddress').value = '';
      }
      cartSidebar.classList.add('translate-x-full');
      checkoutForm.classList.remove('translate-x-full');
      checkoutForm.setAttribute('aria-hidden', 'false');
    }
    function closeCheckoutForm() {
      checkoutForm.classList.add('translate-x-full');
      checkoutForm.setAttribute('aria-hidden', 'true');
    }

    function validateName(name) { return typeof name === 'string' && name.trim().length >= 2; }
    function validateMobile(mobile) { return /^[6-9][0-9]{9}$/.test(mobile); }
    function validateAddress(addr) { return typeof addr === 'string' && addr.trim().length >= 6; }

    function escapeHtml(str) {
      if (!str) return '';
      return str.replace(/[&<>"']/g, function (m) {
        return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'})[m];
      });
    }

    // Order form submit -> create pendingOrder and open whatsappPage
    orderForm.addEventListener('submit', function (e) {
      e.preventDefault();
      const name = document.getElementById('custName').value.trim();
      const mobile = document.getElementById('custMobile').value.trim();
      const address = document.getElementById('custAddress').value.trim();

      document.getElementById('custNameError').classList.add('hidden');
      document.getElementById('custMobileError').classList.add('hidden');
      document.getElementById('custAddressError').classList.add('hidden');

      let ok = true;
      if (!validateName(name)) { document.getElementById('custNameError').classList.remove('hidden'); ok = false; }
      if (!validateMobile(mobile)) { document.getElementById('custMobileError').classList.remove('hidden'); ok = false; }
      if (!validateAddress(address)) { document.getElementById('custAddressError').classList.remove('hidden'); ok = false; }
      if (!ok) { announce('Please correct the highlighted fields.'); return; }

      // save address for next time
      lastAddress = { name, mobile, address };
      persistAddress();

      // create pending order record (we will send this via WhatsApp)
      pendingOrder = {
        id: uid('ORD'),
        createdAt: new Date().toISOString(),
        items: cart.map(i => ({ id: i.id, name: i.name, price: i.price, qty: i.qty })),
        total: computeTotal(),
        customer: { name, mobile, address }
      };
      persistPending();

      // close checkout form and open whatsapp summary page
      closeCheckoutForm();
      openWhatsAppPage();
    });

    function openWhatsAppPage() {
      if (!pendingOrder) { alert('No order to send.'); return; }
      // Prepare summary content
      waTitle.textContent = 'Send Order via WhatsApp';
      const created = new Date(pendingOrder.createdAt).toLocaleString();
      let summary = `<strong>Order ID:</strong> ${escapeHtml(pendingOrder.id)}<br/>`;
      summary += `<strong>Date:</strong> ${created}<br/>`;
      summary += `<strong>Customer:</strong> ${escapeHtml(pendingOrder.customer.name)} ‚Ä¢ ${escapeHtml(pendingOrder.customer.mobile)}<br/>`;
      summary += `<strong>Address:</strong> ${escapeHtml(pendingOrder.customer.address).replace(/\n/g,'<br/>')}<br/><br/>`;
      summary += `<strong>Items:</strong><br/>`;
      summary += pendingOrder.items.map(it => `${escapeHtml(it.name)} √ó ${it.qty} = ${formatCurrency(it.qty * it.price)}`).join('<br/>');
      summary += `<br/><br/><strong>Total:</strong> ${formatCurrency(pendingOrder.total)}`;
      waSummary.innerHTML = summary;

      whatsappPage.classList.remove('hidden');
      whatsappPage.classList.add('flex');
      whatsappPage.setAttribute('aria-hidden', 'false');
    }

    function closeWhatsAppPage() {
      whatsappPage.classList.add('hidden');
      whatsappPage.classList.remove('flex');
      whatsappPage.setAttribute('aria-hidden', 'true');
    }

    // Back button - return to checkout form so user can edit
    backToCheckoutBtn.addEventListener('click', () => {
      closeWhatsAppPage();
      // re-open checkout form prefilled
      if (pendingOrder && pendingOrder.customer) {
        document.getElementById('custName').value = pendingOrder.customer.name || '';
        document.getElementById('custMobile').value = pendingOrder.customer.mobile || '';
        document.getElementById('custAddress').value = pendingOrder.customer.address || '';
      }
      checkoutForm.classList.remove('translate-x-full');
      checkoutForm.setAttribute('aria-hidden', 'false');
    });

    // Send to WhatsApp: open wa.me link with formatted message and save order as "Sent via WhatsApp"
    sendWhatsAppBtn.addEventListener('click', () => {
      if (!pendingOrder) { alert('No order to send.'); return; }
      // Build message text (URL encoded)
      let msg = `*New Order Received*%0A`;
      msg += `Order ID: ${encodeURIComponent(pendingOrder.id)}%0A`;
      msg += `Date: ${encodeURIComponent(new Date(pendingOrder.createdAt).toLocaleString())}%0A%0A`;
      msg += `*Customer*%0AName: ${encodeURIComponent(pendingOrder.customer.name)}%0A`;
      msg += `Mobile: ${encodeURIComponent(pendingOrder.customer.mobile)}%0A`;
      msg += `Address: ${encodeURIComponent(pendingOrder.customer.address)}%0A%0A`;
      msg += `*Items*%0A`;
      pendingOrder.items.forEach(it => {
        msg += `${encodeURIComponent(it.name)} √ó ${it.qty} = ${encodeURIComponent(formatCurrency(it.qty * it.price))}%0A`;
      });
      msg += `%0A*Total:* ${encodeURIComponent(formatCurrency(pendingOrder.total))}%0A%0A`;
      msg += `-- Golden Bites`;

      // Your WhatsApp number (with country code). Provided: 8140314361 -> include +91
      const whatsappNumber = "918140314361";
      const waUrl = `https://wa.me/${whatsappNumber}?text=${msg}`;

      // Show small loading spinner briefly
      loadingSpinner.classList.remove('hidden');
      loadingSpinner.classList.add('flex');

      // Open new tab and then update order status locally
      setTimeout(() => {
        window.open(waUrl, '_blank');

        // mark order as sent via WhatsApp and move to orders history
        const completed = {
          ...pendingOrder,
          paymentMethod: 'WhatsApp',
          status: 'Sent via WhatsApp',
          completedAt: new Date().toISOString()
        };
        orders.push(completed);
        persistOrders();

        // clear cart & pending
        cart = [];
        persistCart();
        pendingOrder = null;
        persistPending();

        updateCart();

        loadingSpinner.classList.add('hidden');
        loadingSpinner.classList.remove('flex');

        closeWhatsAppPage();

        // show success modal
        orderSuccessMsg.innerHTML = `Order <strong>${escapeHtml(completed.id)}</strong> details have been opened in WhatsApp.<br/>Total: <strong>${formatCurrency(completed.total)}</strong><br/>We marked the order as <strong>Sent via WhatsApp</strong>.`;
        orderSuccess.classList.remove('hidden');
        orderSuccess.style.display = 'flex';
        orderSuccess.setAttribute('aria-hidden', 'false');
        announce('Order details sent to WhatsApp.');
      }, 800);
    });

    function closeSuccess() {
      orderSuccess.classList.add('hidden');
      orderSuccess.style.display = 'none';
      orderSuccess.setAttribute('aria-hidden', 'true');
    }

    /* ------------------------------
       Order History modal functions
       ------------------------------ */
    document.getElementById('historyBtn').addEventListener('click', openOrderHistory);

    function openOrderHistory() {
      historyModal.classList.remove('hidden');
      historyModal.classList.add('flex');
      historyModal.setAttribute('aria-hidden', 'false');
      renderOrdersList();
    }
    function closeOrderHistory() {
      historyModal.classList.add('hidden');
      historyModal.classList.remove('flex');
      historyModal.setAttribute('aria-hidden', 'true');
    }

    function renderOrdersList() {
      ordersList.innerHTML = '';
      if (!orders || orders.length === 0) {
        noOrdersMsg.classList.remove('hidden');
        ordersList.classList.add('hidden');
        return;
      }
      noOrdersMsg.classList.add('hidden');
      ordersList.classList.remove('hidden');

      const copy = [...orders].reverse();
      copy.forEach(o => {
        const el = document.createElement('div');
        el.className = 'border rounded p-3';
        el.innerHTML = `
          <div class="flex justify-between items-start">
            <div>
              <div class="font-semibold">Order ${escapeHtml(o.id)}</div>
              <div class="text-sm text-gray-600">${new Date(o.createdAt).toLocaleString()}</div>
            </div>
            <div class="text-yellow-700 font-bold">${formatCurrency(o.total)}</div>
          </div>
          <div class="mt-2 text-sm text-gray-700">Payment: ${escapeHtml(o.paymentMethod)} ‚Ä¢ Status: ${escapeHtml(o.status)}</div>
          <div class="mt-2 text-sm">${escapeHtml(o.customer.name)} ‚Ä¢ ${escapeHtml(o.customer.mobile)}</div>
          <details class="mt-2">
            <summary class="cursor-pointer text-sm text-blue-600">View items (${o.items.length})</summary>
            <ul class="mt-2 text-sm space-y-1">
              ${o.items.map(it => `<li>${escapeHtml(it.name)} ‚Äî ${it.qty} √ó ${formatCurrency(it.price)}</li>`).join('')}
            </ul>
          </details>
        `;
        ordersList.appendChild(el);
      });
    }

    function clearOrders() {
      if (!confirm('Clear all saved orders? This cannot be undone.')) return;
      orders = [];
      persistOrders();
      renderOrdersList();
      announce('Order history cleared');
    }

    /* ------------------------------
       Misc helpers & bindings
       ------------------------------ */
    function persistCart() { save(STORAGE.CART, cart); }
    function persistPendingOrder() { if (pendingOrder) save(STORAGE.PENDING, pendingOrder); else localStorage.removeItem(STORAGE.PENDING); }

    function escapeHtmlForAttr(s) { return (s+'').replace(/"/g,'&quot;'); }

    // payment modal buttons (kept but we hide them to avoid confusion)
    if (document.getElementById('payUPI')) {
      // disable actual payment buttons to honor "no payment option" request
      document.getElementById('payUPI').style.display = 'none';
      document.getElementById('payCard').style.display = 'none';
      document.getElementById('payCOD').style.display = 'none';
    }

    // wire up initial bindings
    document.getElementById('payUPI')?.addEventListener('click', () => { closePaymentModal(); openPaymentPage('UPI'); });
    document.getElementById('payCard')?.addEventListener('click', () => { closePaymentModal(); openPaymentPage('Card'); });
    document.getElementById('payCOD')?.addEventListener('click', () => { closePaymentModal(); confirmOrder('COD'); });

    // enable history button on small screens too
    if (document.getElementById('historyBtn')) {
      document.getElementById('historyBtn').classList.remove('hidden');
    }

    // initial UI sync
    updateCart();
    renderProducts();

    // newsletter demo handler
    document.getElementById('newsletterForm')?.addEventListener('submit', (e) => {
      e.preventDefault();
      const em = document.getElementById('newsletterEmail').value;
      if (!em) { alert('Enter an email'); return; }
      announce('Subscribed to newsletter (demo).');
      alert('Thank you ‚Äî demo subscription received.');
      document.getElementById('newsletterEmail').value = '';
    });

    // quick keyboard shortcuts (optional for power users)
    window.addEventListener('keydown', (e) => {
      if (e.key === 'c' && (e.ctrlKey || e.metaKey)) { e.preventDefault(); openCart(); }
    });

    // small guard: save state on page unload
    window.addEventListener('beforeunload', () => {
      persistCart();
      persistAddress();
      persistOrders();
      persistPending();
    });

    /* ------------------------------
       Dark mode toggle
       ------------------------------ */
    const darkToggle = document.getElementById('darkToggle');
    darkToggle.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark-mode');
    });

    /* ------------------------------
       Stubs for removed payment functions (kept for compatibility)
       ------------------------------ */
    function openPaymentModal(){ /* intentionally left blank - payments removed */ }
    function closePaymentModal(){ /* intentionally left blank - payments removed */ }
    function openPaymentPage(method){ /* intentionally left blank */ }
    function confirmOrder(method){ /* not used - WhatsApp flow will be used */ }

    /* ------------------------------
       Expose debug helpers
       ------------------------------ */
    window._GB = {
      getCart: () => cart,
      getPending: () => pendingOrder,
      getOrders: () => orders,
      clearCart: () => { cart=[]; persistCart(); updateCart(); },
      sendWhatsAppDemo: () => {
        if (!pendingOrder) return alert('No pending order');
        window.open(`https://wa.me/918140314361?text=Demo`, '_blank');
      }
    };
  </script>
</body>
</html>
